
<!-- main sheet code-->
<div class="tab-buttons spaced center">
  <!--_  button(type="action" name=`act_${tab}`) tab-->
  <h1>GODSEND AGENDA</h1>
  <div><span>Page selection</span>
    <select name="attr_sheetTab">
      <option value="character">character</option>
      <option value="notes">notes</option>
      <option value="settings">settings</option>
    </select>
  </div>
  <div class="version"><span>Sheet Version: </span><span name="attr_version"></span></div>
</div>
<input class="tabstoggle" type="hidden" name="attr_sheetTab" value="character"/>
<main class="character">
  <section class="common">
    <div class="columnflex nowrap">
      <label>Name</label>
      <input name="attr_character_name" title="@{character_name}" type="text"/>
    </div>
    <div class="columnflex nowrap">
      <label>Species</label>
      <input name="attr_species" title="@{species}" type="text"/>
    </div>
    <div class="columnflex nowrap">
      <label>Archetype</label>
      <input name="attr_archetype" title="@{archetype}" type="text"/>
    </div>
    <div class="columnflex nowrap">
      <label>Renown</label>
      <input name="attr_renown" title="@{renown}" type="number"/>
    </div>
  </section>
  <section class="points rowflex nowrap spaced">
    <div class="rowflex nowrap"><span>Body Points</span>
      <input class="txtfield" name="attr_body_points" type="number" value=""/><span>/</span>
      <input class="txtfield" name="attr_body_points_max" type="number" value=""/>
    </div>
    <div class="rowflex nowrap"><span>Mind Points</span>
      <input class="txtfield" name="attr_mind_points" type="number" value=""/><span>/</span>
      <input class="txtfield" name="attr_mind_points_max" type="number" value=""/>
    </div>
    <div class="rowflex nowrap"><span>Hero Points</span>
      <input class="txtfield" name="attr_hero_points" title="@{hero_points}" type="number" value=""/><span>/</span>
      <input class="txtfield" name="attr_hero_points_max" title="@{hero_points_max}" type="number" value=""/>
    </div>
    <div class="rowflex nowrap"><span>Wealth Rating</span>
      <input class="txtfield" name="attr_wealth" title="@{wealth}" type="number" value=""/>
    </div>
    <div class="rowflex nowrap"><span>XP</span>
      <input class="txtfield" name="attr_xp" title="@{xp}" type="number" value=""/>
      <input class="txtfield" name="attr_xp_max" title="@{xp_max}" type="number" value=""/>
    </div>
  </section>
  <section class="attrs columnflex nowrap">
    <h2>Attributes</h2>
    <div class="rowflex nowrap middle spaced">
      <div>
        <button name="roll_con" value="@{whisper}&{template:rolls} {{title=con }} {{subtitle=@{character_name} }} {{result= [[@{dice}+@{con}[con]@{modquery}]]}}" type="roll">con</button>
        <input name="attr_con" type="number" title="@{con}" value=""/>
      </div>
      <div>
        <button name="roll_dex" value="@{whisper}&{template:rolls} {{title=dex }} {{subtitle=@{character_name} }} {{result= [[@{dice}+@{dex}[dex]@{modquery}]]}}" type="roll">dex</button>
        <input name="attr_dex" type="number" title="@{dex}" value=""/>
      </div>
      <div>
        <button name="roll_spd" value="@{whisper}&{template:rolls} {{title=spd }} {{subtitle=@{character_name} }} {{result= [[@{dice}+@{spd}[spd]@{modquery}]]}}" type="roll">spd</button>
        <input name="attr_spd" type="number" title="@{spd}" value=""/>
      </div>
      <div>
        <button name="roll_str" value="@{whisper}&{template:rolls} {{title=str }} {{subtitle=@{character_name} }} {{result= [[@{dice}+@{str}[str]@{modquery}]]}}" type="roll">str</button>
        <input name="attr_str" type="number" title="@{str}" value=""/>
      </div>
      <div>
        <button name="roll_cr" value="@{whisper}&{template:rolls} {{title=cr }} {{subtitle=@{character_name} }} {{result= [[@{dice}+@{cr}[cr]@{modquery}]]}}" type="roll">cr</button>
        <input name="attr_cr" type="number" title="@{cr}" value=""/>
      </div>
    </div>
    <div class="rowflex nowrap middle spaced">
      <div>
        <button name="roll_sha" value="@{whisper}&{template:rolls} {{title=sha }} {{subtitle=@{character_name} }} {{result= [[@{dice}+@{sha}[sha]@{modquery}]]}}" type="roll">sha</button>
        <input name="attr_sha" type="number" title="@{sha}" value=""/>
      </div>
      <div>
        <button name="roll_int" value="@{whisper}&{template:rolls} {{title=int }} {{subtitle=@{character_name} }} {{result= [[@{dice}+@{int}[int]@{modquery}]]}}" type="roll">int</button>
        <input name="attr_int" type="number" title="@{int}" value=""/>
      </div>
      <div>
        <button name="roll_per" value="@{whisper}&{template:rolls} {{title=per }} {{subtitle=@{character_name} }} {{result= [[@{dice}+@{per}[per]@{modquery}]]}}" type="roll">per</button>
        <input name="attr_per" type="number" title="@{per}" value=""/>
      </div>
      <div>
        <button name="roll_wil" value="@{whisper}&{template:rolls} {{title=wil }} {{subtitle=@{character_name} }} {{result= [[@{dice}+@{wil}[wil]@{modquery}]]}}" type="roll">wil</button>
        <input name="attr_wil" type="number" title="@{wil}" value=""/>
      </div>
      <div>
        <button name="roll_mr" value="@{whisper}&{template:rolls} {{title=mr }} {{subtitle=@{character_name} }} {{result= [[@{dice}+@{mr}[mr]@{modquery}]]}}" type="roll">mr</button>
        <input name="attr_mr" type="number" title="@{mr}" value=""/>
      </div>
    </div>
  </section>
  <section class="skills columnflex nowrap">
    <h2>Skills</h2>
    <fieldset class="repeating_skills">
      <input name="attr_name" title="@{name}" type="text"/>
      <input name="attr_level" title="@{level}" type="number"/>
      <select name="attr_attribute">
        <option value="[[@{con}]]">con</option>
        <option value="[[@{dex}]]">dex</option>
        <option value="[[@{spd}]]">spd</option>
        <option value="[[@{str}]]">str</option>
        <option value="[[@{cr}]]">cr</option>
        <option value="[[@{sha}]]">sha</option>
        <option value="[[@{int}]]">int</option>
        <option value="[[@{per}]]">per</option>
        <option value="[[@{wil}]]">wil</option>
        <option value="[[@{mr}]]">mr</option>
        <option value="[[@{none}]]">none</option>
      </select>
      <button name="roll_roll" value="@{whisper}&{template:rolls} {{title=@{name} }} {{subtitle=@{character_name} }} {{result= [[@{dice}+@{level}[skill level]+@{attribute}[attribute]@{modquery}]]}}" type="roll"><span name="attr_name"></span></button>
    </fieldset>
  </section>
  <section class="notes columnflex nowrap">
    <h2>Disadvantages</h2>
    <div><span>personal 
        <input name="attr_personal" title="@{personal}" type="text"/>
        <input name="attr_personaldice" title="@{personaldice}" type="number" value=""/></span></div>
    <div><span>internal 
        <input name="attr_internal" title="@{internal}" type="text"/>
        <input name="attr_internaldice" title="@{internaldice}" type="number" value=""/></span></div>
    <div><span>external 
        <input name="attr_external" title="@{external}" type="text"/>
        <input name="attr_externaldice" title="@{externaldice}" type="number" value=""/></span></div>
    <h2>Notes</h2>
    <textarea name="attr_notes"></textarea>
  </section>
</main>
<main class="notes">
  <h1>Notes</h1>
  <section>
    <h3>archetype_description</h3>
    <textarea name="attr_archetype_description"></textarea>
  </section>
  <section>
    <h3>powers</h3>
    <textarea name="attr_powers"></textarea>
  </section>
  <section>
    <h3>weapons</h3>
    <textarea name="attr_weapons"></textarea>
  </section>
  <section>
    <h3>equipment</h3>
    <textarea name="attr_equipment"></textarea>
  </section>
</main>
<main class="settings">
  <h1>Settings</h1>
  <div class="section columnflex nowrap"><span>Ask for Roll Modifiers?</span>
    <select name="attr_modquery" title="@{modquery}">
      <option value="+(?{Roll Modifier|0}[Modifiers])">Yes</option>
      <option value=" ">No</option>
    </select>
  </div>
  <div class="section rowflex nowrap gap"><span title="@{whisper}">Whisper rolls to GM?</span>
    <input name="attr_whisper" title="@{whisper}" type="checkbox" value="/w gm"/>
  </div>
  <div class="section rowflex nowrap gap"><span>Dice type</span>
    <select name="attr_dice" title="@{dice}">
      <option value="2d10cf0cs0" selected="selected">2d10 (GODSEND Agenda)</option>
      <option value="1d20">d20 (Talislanta, Hellas, Atlantis)</option>
    </select>
  </div>
</main>
<!--hidden inputs & datalists-->
<!--sheet version-->
<input type="hidden" name="attr_version" value="1.0.0"/>
<input type="hidden" name="attr_none" value="0"/>
<!--roll templates-->
<rolltemplate class="sheet-rolltemplate-rolls">
  <div class="sheet-container sheet-color-{{color}}">
    <div class="sheet-header">
      {{#title}}<div class="sheet-title">{{title}}</div>{{/title}}
     <!-- {{#name}}<div class="sheet-name">{{name}}</div>{{/name}} -->
      {{#subtitle}}<div class="sheet-subtitle">{{subtitle}}</div>{{/subtitle}}
    </div>
    <div class="sheet-content">
      {{#allprops() title subtitle desc color baseroll}}
      <div class="sheet-key">{{key}}</div>
      <div class="sheet-value">{{value}}</div>
      {{/allprops() title subtitle desc color baseroll}}
      {{#rollTotal() baseroll 2}}
        <div class="sheet-fail">^{critical-fumble}</div>
      {{/rollTotal() baseroll 2}}
      {{#rollTotal() baseroll 12}}
        <div class="sheet-crit">Critical Success!</div>
      {{/rollTotal() baseroll 12}}
      {{#desc}}<div class="sheet-desc">{{desc}}</div>{{/desc}}
    </div>
  </div>
</rolltemplate>

<!--sheetworkers-->
<script type="sheet/worker">

const int = score => parseInt(score, 10) || 0;

// tabs

const buttonlist = ["character", "notes", "settings"];

buttonlist.forEach(button => {
    on(`clicked:${button}`, function() {
      console.log(button + " was pressed");
      setAttrs({
          sheetTab: button
      });
    });
});

</script>